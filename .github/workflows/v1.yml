name: Teams Notify
run-name: v1 workflow

on:
  push:
    branches:
      - v1
  workflow_call:

jobs:
  
 stage_1:
  runs-on: ubuntu-latest
  steps:
      - name: Print User who started workflow
        run: |
          echo "The user who started this workflow is: ${{github.actor}}"
      - name: Sleep for 5 seconds
        run: sleep 5s
        shell: bash
 stage_2:
  runs-on: ubuntu-latest
  needs: stage_1
  steps:
      - name: Print User who started workflow
        run: |
          echo "The user who started this workflow is: ${{github.workflow}}"
      - name: Sleep for 5 seconds
        run: sleep 5s
        shell: bash
 stage_3:
  runs-on: ubuntu-latest
  needs: stage_2
  steps:
      - name: Workflow
        run: |
          echo "The branch is: ${{GITHUB_REF##*/}}"
      - name: Sleep for 5 seconds
        run: sleep 5s
        shell: bash
 stage_4:
  runs-on: ubuntu-latest
  needs: stage_3
  steps:
      - name: Sleep for 5 seconds
        run: sleep 5s
        shell: bash
      - name: Workflow
        run: |
          echo "The workflow is: ${{github.workflow}}"
 stage_5:
  runs-on: ubuntu-latest
  needs: stage_4
  steps:
      - name: Sleep for 5 seconds
        run: sleep 5s
        shell: bash
      - name: Workflow
        run: |
          echo "${{github.actor}} triggered ${{github.workflow}} for ${{ github.event.repository.name }} on  branch ${{GITHUB_REF##*/}}"
 notify_teams_failure:
  runs-on: ubuntu-latest
  needs: stage_5
  if: failure()
  steps:
      - name: Workflow
        run: |
          echo "The workflow is success"
 notify_teams_success:
  runs-on: ubuntu-latest
  needs: stage_5
  if: failure()
  steps:
      - name: Workflow
        run: |
          echo "The workflow is failed "


